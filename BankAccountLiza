/* Final Project GUI
   Name: Liza Carondoy
   Date: December 11, 2025 */

import javax.swing.*;
import java.awt.*;
import java.awt.event.ActionEvent;
import java.awt.event.ActionListener;
import java.text.DecimalFormat;

public class BankAccountLiza extends JFrame implements ActionListener {

    // GUI components
    private JTextField amountField;
    private JButton depositButton;
    private JButton withdrawButton;
    private JButton balanceButton;
    private JTextArea messageArea;

    // Account balance
    private double balance = 0.0;

    // Formatter for money
    private final DecimalFormat moneyFormat = new DecimalFormat("#,##0.00");

    // Custom exception for insufficient funds
    static class InsufficientFundsException extends Exception {
        public InsufficientFundsException(String message) {
            super(message);
        }
    }

    public BankAccountLiza() {
        super("Liza Bank Account Management System");

        // --- Top Panel: Amount Input ---
        JLabel amountLabel = new JLabel("Amount:");
        amountField = new JTextField(10);

        JPanel amountPanel = new JPanel(new FlowLayout());
        amountPanel.add(amountLabel);
        amountPanel.add(amountField);

        // --- Middle Panel: Buttons ---
        depositButton = new JButton("Deposit");
        withdrawButton = new JButton("Withdraw");
        balanceButton = new JButton("Check Balance");

        // ⭐ SET BUTTON COLORS ⭐
        Color darkBlue = new Color(0, 51, 102); // You can adjust this shade!
        Color white = Color.WHITE;

        JButton[] buttons = { depositButton, withdrawButton, balanceButton };

        for (JButton btn : buttons) {
            btn.setBackground(darkBlue);
            btn.setForeground(white);
            btn.setOpaque(true);
            btn.setBorderPainted(false);
            btn.setFocusPainted(false);
        }

        depositButton.addActionListener(this);
        withdrawButton.addActionListener(this);
        balanceButton.addActionListener(this);

        JPanel buttonPanel = new JPanel(new FlowLayout());
        buttonPanel.add(depositButton);
        buttonPanel.add(withdrawButton);
        buttonPanel.add(balanceButton);

        // --- Bottom Panel: Message / Output Area ---
        messageArea = new JTextArea(8, 30);
        messageArea.setEditable(false);
        messageArea.setLineWrap(true);
        messageArea.setWrapStyleWord(true);

        JScrollPane scrollPane = new JScrollPane(
                messageArea,
                JScrollPane.VERTICAL_SCROLLBAR_AS_NEEDED,
                JScrollPane.HORIZONTAL_SCROLLBAR_NEVER
        );

        // --- Main Layout ---
        setLayout(new BorderLayout(5, 5));
        add(amountPanel, BorderLayout.NORTH);
        add(buttonPanel, BorderLayout.CENTER);
        add(scrollPane, BorderLayout.SOUTH);

        setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
        pack();
        setLocationRelativeTo(null); // center on screen
        setVisible(true);

        // Initial message
        showMessage("Current balance: ₱" + moneyFormat.format(balance));
    }

    @Override
    public void actionPerformed(ActionEvent e) {
        Object source = e.getSource();

        try {
            if (source == depositButton) {
                deposit();
            } else if (source == withdrawButton) {
                withdraw();
            } else if (source == balanceButton) {
                checkBalance();
            }
        } catch (NumberFormatException ex) {
            showError("Invalid amount. Please enter a number.");
        } catch (IllegalArgumentException ex) {
            showError(ex.getMessage());
        } catch (InsufficientFundsException ex) {
            showError(ex.getMessage());
        } catch (Exception ex) {
            showError("An unexpected error occurred: " + ex.getMessage());
        }
    }

    private double parseAmount() throws NumberFormatException, IllegalArgumentException {
        String text = amountField.getText().trim();

        if (text.isEmpty()) {
            throw new IllegalArgumentException("Amount is required.");
        }

        double amount = Double.parseDouble(text);

        if (amount <= 0) {
            throw new IllegalArgumentException("Amount must be positive.");
        }

        return amount;
    }

    private void deposit() throws NumberFormatException, IllegalArgumentException {
        double amount = parseAmount();
        balance += amount;
        showMessage("Deposited: ₱" + moneyFormat.format(amount) +
                    "\nNew balance: ₱" + moneyFormat.format(balance));
        amountField.setText("");
    }

    private void withdraw() throws NumberFormatException, IllegalArgumentException, InsufficientFundsException {
        double amount = parseAmount();

        if (amount > balance) {
            throw new InsufficientFundsException("Insufficient funds.");
        }

        balance -= amount;
        showMessage("Withdrew: ₱" + moneyFormat.format(amount) +
                    "\nNew balance: ₱" + moneyFormat.format(balance));
        amountField.setText("");
    }

    private void checkBalance() {
        showMessage("Current balance: ₱" + moneyFormat.format(balance));
    }

    private void showMessage(String message) {
        messageArea.setText(message);
    }

    private void showError(String errorMessage) {
        JOptionPane.showMessageDialog(
                this,
                errorMessage,
                "Error",
                JOptionPane.ERROR_MESSAGE
        );
        messageArea.setText("Error: " + errorMessage);
    }

    public static void main(String[] args) {
        SwingUtilities.invokeLater(new Runnable() {
            @Override
            public void run() {
                new BankAccountLiza();
            }
        });
    }
}
